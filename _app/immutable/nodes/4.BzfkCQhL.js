import"../chunks/DsnmJJEf.js";import{i as wt}from"../chunks/B4jtaNt1.js";import{l as Pt,o as kt,F as xt,G as It,u as q,v as Y,w as e,x as v,q as I,t as Ct,B as _,y as u,z as o,A as n,C as r,D as w,I as g}from"../chunks/B05C3QVk.js";import{i as at}from"../chunks/qQCKdEnz.js";import{e as nt,b as O,r as Q,s as qt,d as C}from"../chunks/BI1NAbvE.js";import{s as Et}from"../chunks/BlywIX0I.js";import{s as Mt,b as St}from"../chunks/CCkwdhXh.js";import{b as At}from"../chunks/BnV46SC_.js";var Lt=q('<button class="suggestion-item svelte-16u7dbs"><span class="suggestion-article svelte-16u7dbs"> </span> <span class="suggestion-info svelte-16u7dbs"> </span></button>'),Nt=q('<div class="suggestions-list svelte-16u7dbs"></div>'),$t=q('<div role="button" tabindex="0"><span class="article svelte-16u7dbs"> </span> <span class="quantity svelte-16u7dbs"> </span> <span class="progress svelte-16u7dbs"> </span></div>'),Ut=q('<div class="modal-overlay svelte-16u7dbs"><div class="modal-content svelte-16u7dbs"><h3 class="svelte-16u7dbs"> </h3> <div class="edit-section svelte-16u7dbs"><h4 class="svelte-16u7dbs">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å:</h4> <input type="text" placeholder="–ê—Ä—Ç–∏–∫—É–ª" class="svelte-16u7dbs"/> <input type="number" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ" class="svelte-16u7dbs"/> <button class="save-button svelte-16u7dbs">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button></div> <div class="modal-actions svelte-16u7dbs"><button class="complete-button svelte-16u7dbs">‚úÖ –û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º</button> <button class="delete-button svelte-16u7dbs">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button> <button class="cancel-button svelte-16u7dbs">–û—Ç–º–µ–Ω–∞</button></div></div></div>'),Xt=q('<main class="svelte-16u7dbs"><h1>–ü–ª–∞–Ω —Ä–∞–±–æ—Ç</h1> <div class="add-plan svelte-16u7dbs"><div class="input-with-suggestions svelte-16u7dbs"><input type="text" placeholder="–ê—Ä—Ç–∏–∫—É–ª" class="svelte-16u7dbs"/> <!></div> <input id="quantity-input" type="number" placeholder="–ö–æ–ª-–≤–æ" class="svelte-16u7dbs"/> <button class="svelte-16u7dbs">–î–æ–±–∞–≤–∏—Ç—å</button></div> <div class="plan-list svelte-16u7dbs"></div> <!> <div class="bottom-nav svelte-16u7dbs"><a class="svelte-16u7dbs">–¥–æ–º–æ–π ‚àÜ</a></div></main>');function zt(it,j){Pt(j,!1);let T=_([]),P=_(!1),k=_([]);function H(t){return t.toFixed(2).replace(/\.?0+$/,"")}let J=_([]),m=_(""),E=_(""),D=_(!1),l=_(null),M=_(""),S=_("");async function A(){n(J,await C.plans.orderBy("id").reverse().toArray())}async function rt(){n(T,await C.norms.orderBy("article").toArray())}async function K(){const t=parseInt(e(E),10);if(e(m).trim()===""||isNaN(t)||t<0){alert("–í–≤–µ–¥–∏—Ç–µ –∞—Ä—Ç–∏–∫—É–ª –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ!");return}const s=t===0;await C.plans.add({article:e(m).trim().toUpperCase(),quantity:t,completed:0,isUnlimited:s}),n(m,""),n(E,""),await A()}const lt=2e3,W=10,y=new Map;function ot(t,s){if(t instanceof PointerEvent&&t.button&&t.button!==0)return;const a=t.pointerId,i=t.clientX??0,c=t.clientY??0;y.has(a)&&L(a);const p=window.setTimeout(()=>{const b=y.get(a);b&&(b.triggered=!0),Z(s)},lt);y.set(a,{timeoutId:p,startX:i,startY:c,triggered:!1});const f=t.target;try{f?.setPointerCapture?.(a)}catch{}}function ct(t){const s=t.pointerId,a=y.get(s);if(!a)return;const i=Math.abs((t.clientX??0)-a.startX),c=Math.abs((t.clientY??0)-a.startY);(i>W||c>W)&&L(s)}function ut(t){const s=t.pointerId,a=y.get(s);if(!a)return;const i=a.triggered;L(s);const c=t.target;try{c?.releasePointerCapture?.(s)}catch{}i&&t.target?.addEventListener("click",vt,{capture:!0,once:!0})}function dt(t){L(t.pointerId)}function L(t){const s=y.get(t);s&&(s.timeoutId!=null&&clearTimeout(s.timeoutId),y.delete(t))}function vt(t){t.stopImmediatePropagation(),t.preventDefault()}function Z(t){n(l,t),n(D,!0)}function pt(){e(l)&&!e(l).isUnlimited?confirm(`–û—Ç–º–µ—Ç–∏—Ç—å –ø–ª–∞–Ω "${e(l).article}" –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–π?`)&&tt({completed:e(l).quantity}):alert("–ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π –ø–ª–∞–Ω –Ω–µ–ª—å–∑—è –æ—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º.")}async function bt(){if(e(l)){if(e(l).completed>0){alert("–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –ø–ª–∞–Ω, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É —É–∂–µ –µ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã!");return}confirm(`–£–¥–∞–ª–∏—Ç—å –ø–ª–∞–Ω "${e(l).article}"?`)&&(await C.plans.delete(e(l).id),N(),await A())}}async function tt(t){if(e(l))try{await C.plans.update(e(l).id,t),N(),await A()}catch(s){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø–ª–∞–Ω–∞:",s),alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.")}}function N(){n(D,!1),n(l,null),n(M,""),n(S,"")}function ft(t){n(m,t),n(P,!1),document.getElementById("quantity-input")?.focus()}kt(()=>{A(),rt()}),xt(()=>(e(m),e(k),e(T)),()=>{e(m).trim()!==""?(n(k,e(T).filter(t=>t.article.toLowerCase().includes(e(m).toLowerCase()))),n(P,e(k).length>0)):(n(k,[]),n(P,!1))}),It(),wt();var F=Xt(),G=o(u(F),2),z=u(G),$=u(z);Q($);var mt=o($,2);{var _t=t=>{var s=Nt();nt(s,5,()=>e(k),a=>a.id,(a,i)=>{var c=Lt(),p=u(c),f=u(p,!0);r(p);var b=o(p,2),h=u(b);r(b),r(c),Y(()=>{w(f,(e(i),g(()=>e(i).article))),w(h,`${e(i),g(()=>e(i).time)??""}—á`)}),v("click",c,()=>ft(e(i).article)),I(a,c)}),r(s),I(t,s)};at(mt,t=>{e(P)&&t(_t)})}r(z);var U=o(z,2);Q(U);var yt=o(U,2);r(G);var R=o(G,2);nt(R,5,()=>e(J),t=>t.id,(t,s)=>{var a=$t();let i;var c=u(a),p=u(c,!0);r(c);var f=o(c,2),b=u(f);r(f);var h=o(f,2),X=u(h);r(h),r(a),Y((d,B,V)=>{i=Et(a,1,"plan-item svelte-16u7dbs",null,i,d),w(p,(e(s),g(()=>e(s).article))),w(b,`${B??""}—à—Ç`),w(X,`... ${V??""}—à—Ç`)},[()=>({completed:e(s).quantity>0&&e(s).completed>=e(s).quantity}),()=>(e(s),g(()=>H(e(s).quantity))),()=>(e(s),g(()=>H(e(s).completed)))]),v("pointerdown",a,d=>ot(d,e(s))),v("pointermove",a,d=>ct(d)),v("pointerup",a,d=>ut(d)),v("pointercancel",a,d=>dt(d)),v("keydown",a,d=>d.key==="Enter"&&Z(e(s))),I(t,a)}),r(R);var et=o(R,2);{var gt=t=>{var s=Ut(),a=u(s),i=u(a),c=u(i);r(i);var p=o(i,2),f=o(u(p),2);Q(f);var b=o(f,2);Q(b);var h=o(b,2);r(p);var X=o(p,2),d=u(X),B=o(d,2),V=o(B,2);r(X),r(a),r(s),Y(()=>{w(c,`–î–µ–π—Å—Ç–≤–∏—è —Å –ø–ª–∞–Ω–æ–º: ${e(l),g(()=>e(l).article)??""}`),d.disabled=(e(l),g(()=>e(l).isUnlimited))}),O(f,()=>e(M),x=>n(M,x)),O(b,()=>e(S),x=>n(S,x)),v("click",h,()=>tt({article:e(M).trim().toUpperCase(),quantity:parseInt(e(S),10)})),v("click",d,pt),v("click",B,bt),v("click",V,N),v("click",a,Mt(function(x){St.call(this,j,x)})),v("click",s,N),I(t,s)};at(et,t=>{e(D)&&e(l)&&t(gt)})}var st=o(et,2),ht=u(st);r(st),r(F),Y(()=>qt(ht,"href",`${At??""}/`)),O($,()=>e(m),t=>n(m,t)),v("focus",$,()=>n(P,e(m).trim()!=="")),O(U,()=>e(E),t=>n(E,t)),v("keydown",U,t=>t.key==="Enter"&&K()),v("click",yt,K),I(it,F),Ct()}export{zt as component};
