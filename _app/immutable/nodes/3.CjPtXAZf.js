import"../chunks/DsnmJJEf.js";import{i as it}from"../chunks/B4jtaNt1.js";import{l as lt,o as ct,u as O,v as L,w as s,x as n,q as Y,t as dt,y as d,z as i,A as l,B as g,C as c,D as B}from"../chunks/B05C3QVk.js";import{i as ut}from"../chunks/qQCKdEnz.js";import{e as vt,b as I,r as C,s as mt,d as M}from"../chunks/BI1NAbvE.js";import{s as pt,b as ft}from"../chunks/CCkwdhXh.js";import{b as gt}from"../chunks/BWGyP8pp.js";var bt=O('<div class="norm-item svelte-guxod4" role="button" tabindex="0"><span class="article svelte-guxod4"> </span> <span class="time svelte-guxod4"> </span></div>'),_t=O('<div class="modal-overlay svelte-guxod4"><div class="modal-content svelte-guxod4"><h3 class="svelte-guxod4"> </h3> <div class="edit-section svelte-guxod4"><h4 class="svelte-guxod4">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å:</h4> <input type="text" placeholder="–ê—Ä—Ç–∏–∫—É–ª" class="svelte-guxod4"/> <input type="number" step="0.1" placeholder="–í—Ä–µ–º—è (—á)" class="svelte-guxod4"/> <button class="save-button svelte-guxod4">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button></div> <div class="modal-actions svelte-guxod4"><button class="delete-button svelte-guxod4">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button> <button class="cancel-button svelte-guxod4">–û—Ç–º–µ–Ω–∞</button></div></div></div>'),xt=O('<main class="svelte-guxod4"><h1>–ù–æ—Ä–º—ã –≤—Ä–µ–º–µ–Ω–∏</h1> <div class="add-norm svelte-guxod4"><input type="text" placeholder="–ê—Ä—Ç–∏–∫—É–ª" class="svelte-guxod4"/> <input id="time-input" type="number" step="0.1" placeholder="–í—Ä–µ–º—è (—á)" class="svelte-guxod4"/> <button class="svelte-guxod4">–î–æ–±–∞–≤–∏—Ç—å</button></div> <div class="norm-list svelte-guxod4"></div> <!> <div class="bottom-nav svelte-guxod4"><a class="svelte-guxod4">–¥–æ–º–æ–π ‚àÜ</a></div></main>');function It(j,D){lt(D,!1);let F=g([]),b=g(""),x=g(""),A=g(!1),u=g(null),h=g(""),y=g("");async function w(){l(F,await M.norms.orderBy("article").toArray())}async function U(){const t=parseFloat(s(x));if(s(b).trim()===""||isNaN(t)||t<=0){alert("–í–≤–µ–¥–∏—Ç–µ –∞—Ä—Ç–∏–∫—É–ª –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –≤—Ä–µ–º—è!");return}await M.norms.add({article:s(b).trim().toUpperCase(),time:t}),l(b,""),l(x,""),await w()}const H=500,$=10,p=new Map;function J(t,a){if(t instanceof PointerEvent&&t.button&&t.button!==0)return;const e=t.pointerId,r=t.clientX??0,v=t.clientY??0;p.has(e)&&k(e);const m=window.setTimeout(()=>{const o=p.get(e);o&&(o.triggered=!0),q(a)},H);p.set(e,{timeoutId:m,startX:r,startY:v,triggered:!1});const f=t.target;try{f?.setPointerCapture?.(e)}catch{}}function K(t){const a=t.pointerId,e=p.get(a);if(!e)return;const r=Math.abs((t.clientX??0)-e.startX),v=Math.abs((t.clientY??0)-e.startY);(r>$||v>$)&&k(a)}function Q(t){const a=t.pointerId,e=p.get(a);if(!e)return;const r=e.triggered;k(a);const v=t.target;try{v?.releasePointerCapture?.(a)}catch{}r&&t.target?.addEventListener("click",Z,{capture:!0,once:!0})}function W(t){k(t.pointerId)}function k(t){const a=p.get(t);a&&(a.timeoutId!=null&&clearTimeout(a.timeoutId),p.delete(t))}function Z(t){t.stopImmediatePropagation(),t.preventDefault()}function q(t){l(u,t),l(A,!0)}async function tt(){s(u)&&confirm(`–£–¥–∞–ª–∏—Ç—å –Ω–æ—Ä–º—É "${s(u).article}"?`)&&(await M.norms.delete(s(u).id),P(),await w())}async function et(t){if(s(u))try{await M.norms.update(s(u).id,t),P(),await w()}catch(a){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –Ω–æ—Ä–º—ã:",a),alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.")}}function P(){l(A,!1),l(u,null),l(h,""),l(y,"")}ct(()=>{w()}),it();var S=xt(),T=i(d(S),2),N=d(T);C(N);var E=i(N,2);C(E);var at=i(E,2);c(T);var X=i(T,2);vt(X,5,()=>s(F),t=>t.id,(t,a)=>{var e=bt(),r=d(e),v=d(r,!0);c(r);var m=i(r,2),f=d(m);c(m),c(e),L(()=>{B(v,s(a).article),B(f,`${s(a).time??""}—á`)}),n("pointerdown",e,o=>J(o,s(a))),n("pointermove",e,o=>K(o)),n("pointerup",e,o=>Q(o)),n("pointercancel",e,o=>W(o)),n("keydown",e,o=>o.key==="Enter"&&q(s(a))),Y(t,e)}),c(X);var z=i(X,2);{var st=t=>{var a=_t(),e=d(a),r=d(e),v=d(r);c(r);var m=i(r,2),f=i(d(m),2);C(f);var o=i(f,2);C(o);var rt=i(o,2);c(m);var R=i(m,2),V=d(R),nt=i(V,2);c(R),c(e),c(a),L(()=>B(v,`–î–µ–π—Å—Ç–≤–∏—è —Å –Ω–æ—Ä–º–æ–π: ${s(u).article??""}`)),I(f,()=>s(h),_=>l(h,_)),I(o,()=>s(y),_=>l(y,_)),n("click",rt,()=>et({article:s(h).trim().toUpperCase(),time:parseFloat(s(y))})),n("click",V,tt),n("click",nt,P),n("click",e,pt(function(_){ft.call(this,D,_)})),n("click",a,P),Y(t,a)};ut(z,t=>{s(A)&&s(u)&&t(st)})}var G=i(z,2),ot=d(G);c(G),c(S),L(()=>mt(ot,"href",`${gt??""}/`)),I(N,()=>s(b),t=>l(b,t)),n("keydown",N,t=>{t.key==="Enter"&&document.getElementById("time-input")?.focus()}),I(E,()=>s(x),t=>l(x,t)),n("keydown",E,t=>t.key==="Enter"&&U()),n("click",at,U),Y(j,S),dt()}export{It as component};
